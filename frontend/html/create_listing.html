{% extends "base.html" %}

{% block title %}Create Listing{% endblock %}

{% block content %}
<div class="container">
  <h1>Create Listing</h1>
  <form action="/listings" method="POST" enctype="multipart/form-data">
    <label>Title:<input name="title" required></label>
    <label>Bedrooms Available:<input type="number" name="bedrooms_available" min="0" required></label>
    <label>Total Rooms:<input type="number" name="total_rooms" min="0" required></label>
    <label>Bedrooms In Use:<input type="number" name="bedrooms_in_use" min="0" required></label>
    <label>Bathrooms:<input type="number" name="bathrooms" min="0" required></label>
    <label>Cost / Month:<input type="number" step="0.01" name="cost_per_month" min="0" required></label>
    <label>Available Start Date:<input type="date" name="available_start_date" required></label>
    <label>Available End Date:<input type="date" name="available_end_date" required></label>
    <label>Address:<input name="address" required></label>
    <label>City:<input name="city" required></label>
    <label>State:<input name="state" required></label>
    <label>Zip Code:<input name="zip_code" required></label>
    <label>Amenities (comma separated):<input name="amenities"></label>
    <label>Upload 4 images of your apartment:
      <input type="file" name="image1" accept="image/*">
      <input type="file" name="image2" accept="image/*">
      <input type="file" name="image3" accept="image/*">
      <input type="file" name="image4" accept="image/*">
    </label>
    <button type="submit">Create</button>
  </form>
  <p><a href="/profile">Back to Profile</a></p>
</div>

<script>
  const form = document.querySelector('form');
  
  form.addEventListener('submit', async (e) => {
    e.preventDefault();
    
    const formData = new FormData(form);
    
    const response = await fetch('/listings', {
      method: 'POST',
      body: formData
    });

    if (response.ok) {
      window.location.href = '/profile'; // Redirect to profile page
    } else {
      alert('Failed to create listing.');
    }
  });
</script>

{% endblock %}
